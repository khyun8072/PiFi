 2025-01-26 05:18:08 - Start training from epoch 0
 2025-01-26 05:18:08 - TRAIN - Epoch [0 / 3] - Iter[0 / 906] - Loss: 267.7232
Training - Epoch [0/3]:   0%|                                                                          | 0/906 [00:00<?, ?it/s]The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
Passing a tuple of `past_key_values` is deprecated and will be removed in Transformers v4.48.0. You should pass an instance of `EncoderDecoderCache` instead, e.g. `past_key_values=EncoderDecoderCache.from_legacy_cache(past_key_values)`.



























































































































































Training - Epoch [0/3]:  55%|███████████████████████████████████▏                            | 499/906 [07:38<03:35,  1.89it/s]
































































































































Training - Epoch [0/3]: 100%|███████████████████████████████████████████████████████████████▉| 905/906 [13:59<00:00,  1.39it/s]
 2025-01-26 05:32:08 - TRAIN - Epoch [0 / 3] - Iter[905 / 906] - Loss: 2.1095
Training - Epoch [0/3]: 100%|████████████████████████████████████████████████████████████████| 906/906 [13:59<00:00,  1.08it/s]




Validating - Epoch [0 / 3]: 100%|██████████████████████████████████████████████████████████████| 31/31 [00:19<00:00,  1.60it/s]
 2025-01-26 05:32:27 - VALID - Epoch [0 / 3] - Iter [30 / 31] - Loss: 1.6681
 2025-01-26 05:32:27 - VALID - Saving checkpoint for best valid loss...
 2025-01-26 05:33:06 - VALID - Best valid at epoch 0 - loss: 1.6119
 2025-01-26 05:33:06 - VALID - Saved checkpoint to /nas_homes/kyeonghyun/model_checkpoint/PiFi_Generation/translation/multi30k/t5/base_llm/llama3.1/0
 2025-01-26 05:33:06 - TRAIN - Epoch [1 / 3] - Iter[0 / 906] - Loss: 2.0713






























































































































































Training - Epoch [1/3]:  55%|███████████████████████████████████▎                            | 500/906 [07:41<04:01,  1.68it/s]


































































































































Training - Epoch [1/3]: 100%|████████████████████████████████████████████████████████████████| 906/906 [13:58<00:00,  1.08it/s]
Validating - Epoch [1 / 3]:   3%|██                                                             | 1/31 [00:00<00:08,  3.48it/s]
 2025-01-26 05:47:04 - TRAIN - Epoch [1 / 3] - Iter[905 / 906] - Loss: 1.4391






Validating - Epoch [1 / 3]:  94%|██████████████████████████████████████████████████████████    | 29/31 [00:18<00:01,  1.18it/s]
 2025-01-26 05:47:23 - VALID - Epoch [1 / 3] - Iter [30 / 31] - Loss: 1.2538

Validating - Epoch [1 / 3]: 100%|██████████████████████████████████████████████████████████████| 31/31 [00:18<00:00,  1.65it/s]
 2025-01-26 05:48:00 - VALID - Best valid at epoch 1 - loss: 1.2076
 2025-01-26 05:48:00 - VALID - Saved checkpoint to /nas_homes/kyeonghyun/model_checkpoint/PiFi_Generation/translation/multi30k/t5/base_llm/llama3.1/0
 2025-01-26 05:48:01 - TRAIN - Epoch [2 / 3] - Iter[0 / 906] - Loss: 1.5076



































































































































































Training - Epoch [2/3]:  55%|███████████████████████████████████▎                            | 500/906 [07:38<05:35,  1.21it/s]



































































































































Training - Epoch [2/3]: 100%|████████████████████████████████████████████████████████████████| 906/906 [13:52<00:00,  1.09it/s]
Validating - Epoch [2 / 3]:  16%|██████████▏                                                    | 5/31 [00:01<00:04,  5.20it/s]
 2025-01-26 06:01:53 - TRAIN - Epoch [2 / 3] - Iter[905 / 906] - Loss: 1.1486






Validating - Epoch [2 / 3]: 100%|██████████████████████████████████████████████████████████████| 31/31 [00:18<00:00,  1.66it/s]
 2025-01-26 06:02:11 - VALID - Epoch [2 / 3] - Iter [30 / 31] - Loss: 1.0958
 2025-01-26 06:02:12 - VALID - Saving checkpoint for best valid loss...
 2025-01-26 06:02:49 - VALID - Best valid at epoch 2 - loss: 1.0509
 2025-01-26 06:02:49 - VALID - Saved checkpoint to /nas_homes/kyeonghyun/model_checkpoint/PiFi_Generation/translation/multi30k/t5/base_llm/llama3.1/0
 2025-01-26 06:02:49 - Done! Best valid at epoch 2 - loss: 1.0509
 2025-01-26 06:04:02 - FINAL - Saved final model to /nas_homes/kyeonghyun/model_final/PiFi_Generation/translation/multi30k/t5/base_llm/llama3.1/0